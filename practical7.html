<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Guillaume Pain" />


<title>Practical 7</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Guillaume Pain Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="practical1.html">Practical 1</a>
</li>
<li>
  <a href="practical2.html">Practical 2</a>
</li>
<li>
  <a href="practical3.html">Practical 3</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Practical 7</h1>
<h4 class="author">Guillaume Pain</h4>
<h4 class="date">23/03/2022</h4>

</div>


<p>Import Data and pacakge</p>
<pre class="r"><code>install.packages(pkgs=&quot;http://www.karlin.mff.cuni.cz/~hlavka/sms2/SMSdata_1.0.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)</code></pre>
<pre><code>## Installation du package dans &#39;C:/Users/guill/OneDrive/Documents/R/win-library/4.1&#39;
## (car &#39;lib&#39; n&#39;est pas spécifié)</code></pre>
<pre class="r"><code>library(SMSdata)
data(food)
library(&quot;FactoMineR&quot;)</code></pre>
<pre><code>## Warning: le package &#39;FactoMineR&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre class="r"><code>library(&quot;factoextra&quot;)</code></pre>
<pre><code>## Warning: le package &#39;factoextra&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Le chargement a nécessité le package : ggplot2</code></pre>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<pre class="r"><code>library(&quot;qgraph&quot;)</code></pre>
<pre><code>## Warning: le package &#39;qgraph&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre class="r"><code>library(corrplot)</code></pre>
<pre><code>## corrplot 0.92 loaded</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## Warning: le package &#39;tidyverse&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v tibble  3.1.6     v dplyr   1.0.8
## v tidyr   1.2.0     v stringr 1.4.0
## v readr   2.1.2     v forcats 0.5.1
## v purrr   0.3.4</code></pre>
<pre><code>## Warning: le package &#39;readr&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Warning: le package &#39;forcats&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(psych)</code></pre>
<pre><code>## Warning: le package &#39;psych&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## 
## Attachement du package : &#39;psych&#39;</code></pre>
<pre><code>## Les objets suivants sont masqués depuis &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<p>Evaluate the correlation matrix</p>
<pre class="r"><code>library(RcmdrMisc)</code></pre>
<pre><code>## Warning: le package &#39;RcmdrMisc&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Le chargement a nécessité le package : car</code></pre>
<pre><code>## Le chargement a nécessité le package : carData</code></pre>
<pre><code>## 
## Attachement du package : &#39;car&#39;</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:psych&#39;:
## 
##     logit</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre><code>## Le chargement a nécessité le package : sandwich</code></pre>
<pre><code>## Warning: le package &#39;sandwich&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## 
## Attachement du package : &#39;RcmdrMisc&#39;</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:psych&#39;:
## 
##     reliability</code></pre>
<pre class="r"><code>rcorr.adjust(food) # This function is build into R Commander.</code></pre>
<pre><code>## 
##  Pearson correlations:
##             bread vegetables  fruits    meat poultry   milk    wine
## bread      1.0000     0.5931  0.1961  0.3213  0.2480 0.8556  0.3038
## vegetables 0.5931     1.0000  0.8563  0.8811  0.8268 0.6628 -0.3565
## fruits     0.1961     0.8563  1.0000  0.9595  0.9255 0.3322 -0.4863
## meat       0.3213     0.8811  0.9595  1.0000  0.9818 0.3746 -0.4372
## poultry    0.2480     0.8268  0.9255  0.9818  1.0000 0.2329 -0.4002
## milk       0.8556     0.6628  0.3322  0.3746  0.2329 1.0000  0.0069
## wine       0.3038    -0.3565 -0.4863 -0.4372 -0.4002 0.0069  1.0000
## 
##  Number of observations: 12 
## 
##  Pairwise two-sided p-values:
##            bread  vegetables fruits meat   poultry milk   wine  
## bread             0.0421     0.5412 0.3086 0.4370  0.0004 0.3371
## vegetables 0.0421            0.0004 0.0002 0.0009  0.0188 0.2554
## fruits     0.5412 0.0004            &lt;.0001 &lt;.0001  0.2915 0.1089
## meat       0.3086 0.0002     &lt;.0001        &lt;.0001  0.2303 0.1552
## poultry    0.4370 0.0009     &lt;.0001 &lt;.0001         0.4663 0.1974
## milk       0.0004 0.0188     0.2915 0.2303 0.4663         0.9831
## wine       0.3371 0.2554     0.1089 0.1552 0.1974  0.9831       
## 
##  Adjusted p-values (Holm&#39;s method)
##            bread  vegetables fruits meat   poultry milk   wine  
## bread             0.5471     1.0000 1.0000 1.0000  0.0064 1.0000
## vegetables 0.5471            0.0064 0.0028 0.0137  0.2635 1.0000
## fruits     1.0000 0.0064            &lt;.0001 0.0003  1.0000 1.0000
## meat       1.0000 0.0028     &lt;.0001        &lt;.0001  1.0000 1.0000
## poultry    1.0000 0.0137     0.0003 &lt;.0001         1.0000 1.0000
## milk       0.0064 0.2635     1.0000 1.0000 1.0000         1.0000
## wine       1.0000 1.0000     1.0000 1.0000 1.0000  1.0000</code></pre>
<p>KMO Test (Kaiser-Meyer-Olkin)</p>
<pre class="r"><code>library(psych)

KMO(food)</code></pre>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = food)
## Overall MSA =  0.46
## MSA for each item = 
##      bread vegetables     fruits       meat    poultry       milk       wine 
##       0.55       0.51       0.50       0.48       0.46       0.39       0.25</code></pre>
<ul>
<li>0.00 to 0.49 unacceptable</li>
<li>0.50 to 0.59 miserable</li>
</ul>
<p>The Kaiser–Meyer–Olkin (KMO) test is a statistical measure to determine how suited data is for factor analysis.</p>
<p>Factor analysis does not seem to be very suitable for our data.</p>
<pre class="r"><code>scree(food, pc=FALSE)  # Use pc=FALSE for factor analysis</code></pre>
<pre><code>## Warning in fa.stats(r = r, f = f, phi = phi, n.obs = n.obs, np.obs = np.obs, :
## The estimated weights for the factor scores are probably incorrect. Try a
## different factor score estimation method.</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-4-1.png" width="672" /> Two axes will be chosen to explain FA.</p>
<p>Realisation FA</p>
<pre class="r"><code>fa.food &lt;- factanal(food, factors = 2, rotation=&quot;varimax&quot;) #factor = 2 : number axis.
print(fa.food, digits=2, cutoff=.6, sort=TRUE)</code></pre>
<pre><code>## 
## Call:
## factanal(x = food, factors = 2, rotation = &quot;varimax&quot;)
## 
## Uniquenesses:
##      bread vegetables     fruits       meat    poultry       milk       wine 
##       0.27       0.09       0.09       0.00       0.01       0.00       0.79 
## 
## Loadings:
##            Factor1 Factor2
## vegetables  0.75          
## fruits      0.93          
## meat        0.96          
## poultry     0.99          
## bread               0.85  
## milk                0.99  
## wine                      
## 
##                Factor1 Factor2
## SS loadings       3.55    2.20
## Proportion Var    0.51    0.31
## Cumulative Var    0.51    0.82
## 
## Test of the hypothesis that 2 factors are sufficient.
## The chi square statistic is 23.27 on 8 degrees of freedom.
## The p-value is 0.00303</code></pre>
<pre class="r"><code>library(psych)

loads &lt;- fa.food$loadings

fa.diagram(loads)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-6-1.png" width="672" /> axis 1 : poultry / meat / fruits / vegetables / (wine..)</p>
<p>axis 2 : Milk / bread</p>
<pre class="r"><code>load &lt;- fa.food$loadings[,1:2] 
plot(load,type=&quot;n&quot;) 
text(load,labels=names(food),cex=.7)

lines(c(-1,1),c(0,0), lty = 3)
lines(c(0,0),c(-1,1), lty = 3)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>rbPal &lt;- colorRampPalette(c(&#39;red&#39;,&#39;blue&#39;))

loadings &lt;- data.frame(fa.food$loadings[,1:2])

loadings$colF1 &lt;- rbPal(20)[as.numeric(cut(loadings[,1],breaks = seq(-1,1,length = 20)))]
loadings$nam1 &lt;- paste(row.names(loadings), round(loadings[,1], digits = 3), sep = &quot;\n&quot;)
loadings$colF2 &lt;- rbPal(20)[as.numeric(cut(loadings[,2],breaks = seq(-1,1,length = 20)))]
loadings$nam2 &lt;- paste(row.names(loadings), round(loadings[,2], digits = 3), sep = &quot;\n&quot;)


par(mfrow = c(2,1))
barplot(abs(loadings[,1]), col = loadings$colF1, ylim = c(0,1), ylab = &quot;Factor 1&quot;, names.arg = loadings$nam1, cex.names = 0.8)
barplot(abs(loadings[,2]), col = loadings$colF2, ylim = c(0,1), ylab = &quot;Factor 2&quot;, names.arg = loadings$nam2, cex.names = 0.8)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-8-1.png" width="672" /> representation of each variable on each axis</p>
<pre class="r"><code>round(fa.food$loadings, 3)</code></pre>
<pre><code>## 
## Loadings:
##            Factor1 Factor2
## bread       0.101   0.850 
## vegetables  0.754   0.588 
## fruits      0.926   0.236 
## meat        0.959   0.275 
## poultry     0.985   0.131 
## milk        0.105   0.992 
## wine       -0.459         
## 
##                Factor1 Factor2
## SS loadings      3.548   2.204
## Proportion Var   0.507   0.315
## Cumulative Var   0.507   0.822</code></pre>
<p>Comparaison with PCA :</p>
<p>During the PCA we also noticed that it was necessary to keep just 2 axes.</p>
<p>Resultat :</p>
<pre class="r"><code>res&lt;-PCA(food, scale.unit = TRUE, ncp = 5, graph = F)
var &lt;- get_pca_var(res)
corrplot(var$contrib, is.corr=FALSE)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>This graph shows that the important variables for each axis are the same for PCA and FA.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
=======
<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Guillaume Pain" />


<title>Practical 7</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Guillaume Pain Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="practical1.html">Practical 1</a>
</li>
<li>
  <a href="practical2.html">Practical 2</a>
</li>
<li>
  <a href="practical3.html">Practical 3</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Practical 7</h1>
<h4 class="author">Guillaume Pain</h4>
<h4 class="date">23/03/2022</h4>

</div>


<p>Import Data and pacakge</p>
<pre class="r"><code>install.packages(pkgs=&quot;http://www.karlin.mff.cuni.cz/~hlavka/sms2/SMSdata_1.0.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)</code></pre>
<pre><code>## Installation du package dans &#39;C:/Users/guill/OneDrive/Documents/R/win-library/4.1&#39;
## (car &#39;lib&#39; n&#39;est pas spécifié)</code></pre>
<pre class="r"><code>library(SMSdata)
data(food)
library(&quot;FactoMineR&quot;)</code></pre>
<pre><code>## Warning: le package &#39;FactoMineR&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre class="r"><code>library(&quot;factoextra&quot;)</code></pre>
<pre><code>## Warning: le package &#39;factoextra&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Le chargement a nécessité le package : ggplot2</code></pre>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<pre class="r"><code>library(&quot;qgraph&quot;)</code></pre>
<pre><code>## Warning: le package &#39;qgraph&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre class="r"><code>library(corrplot)</code></pre>
<pre><code>## corrplot 0.92 loaded</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## Warning: le package &#39;tidyverse&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v tibble  3.1.6     v dplyr   1.0.8
## v tidyr   1.2.0     v stringr 1.4.0
## v readr   2.1.2     v forcats 0.5.1
## v purrr   0.3.4</code></pre>
<pre><code>## Warning: le package &#39;readr&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Warning: le package &#39;forcats&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(psych)</code></pre>
<pre><code>## Warning: le package &#39;psych&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## 
## Attachement du package : &#39;psych&#39;</code></pre>
<pre><code>## Les objets suivants sont masqués depuis &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<p>Evaluate the correlation matrix</p>
<pre class="r"><code>library(RcmdrMisc)</code></pre>
<pre><code>## Warning: le package &#39;RcmdrMisc&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## Le chargement a nécessité le package : car</code></pre>
<pre><code>## Le chargement a nécessité le package : carData</code></pre>
<pre><code>## 
## Attachement du package : &#39;car&#39;</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:psych&#39;:
## 
##     logit</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre><code>## Le chargement a nécessité le package : sandwich</code></pre>
<pre><code>## Warning: le package &#39;sandwich&#39; a été compilé avec la version R 4.1.3</code></pre>
<pre><code>## 
## Attachement du package : &#39;RcmdrMisc&#39;</code></pre>
<pre><code>## L&#39;objet suivant est masqué depuis &#39;package:psych&#39;:
## 
##     reliability</code></pre>
<pre class="r"><code>rcorr.adjust(food) # This function is build into R Commander.</code></pre>
<pre><code>## 
##  Pearson correlations:
##             bread vegetables  fruits    meat poultry   milk    wine
## bread      1.0000     0.5931  0.1961  0.3213  0.2480 0.8556  0.3038
## vegetables 0.5931     1.0000  0.8563  0.8811  0.8268 0.6628 -0.3565
## fruits     0.1961     0.8563  1.0000  0.9595  0.9255 0.3322 -0.4863
## meat       0.3213     0.8811  0.9595  1.0000  0.9818 0.3746 -0.4372
## poultry    0.2480     0.8268  0.9255  0.9818  1.0000 0.2329 -0.4002
## milk       0.8556     0.6628  0.3322  0.3746  0.2329 1.0000  0.0069
## wine       0.3038    -0.3565 -0.4863 -0.4372 -0.4002 0.0069  1.0000
## 
##  Number of observations: 12 
## 
##  Pairwise two-sided p-values:
##            bread  vegetables fruits meat   poultry milk   wine  
## bread             0.0421     0.5412 0.3086 0.4370  0.0004 0.3371
## vegetables 0.0421            0.0004 0.0002 0.0009  0.0188 0.2554
## fruits     0.5412 0.0004            &lt;.0001 &lt;.0001  0.2915 0.1089
## meat       0.3086 0.0002     &lt;.0001        &lt;.0001  0.2303 0.1552
## poultry    0.4370 0.0009     &lt;.0001 &lt;.0001         0.4663 0.1974
## milk       0.0004 0.0188     0.2915 0.2303 0.4663         0.9831
## wine       0.3371 0.2554     0.1089 0.1552 0.1974  0.9831       
## 
##  Adjusted p-values (Holm&#39;s method)
##            bread  vegetables fruits meat   poultry milk   wine  
## bread             0.5471     1.0000 1.0000 1.0000  0.0064 1.0000
## vegetables 0.5471            0.0064 0.0028 0.0137  0.2635 1.0000
## fruits     1.0000 0.0064            &lt;.0001 0.0003  1.0000 1.0000
## meat       1.0000 0.0028     &lt;.0001        &lt;.0001  1.0000 1.0000
## poultry    1.0000 0.0137     0.0003 &lt;.0001         1.0000 1.0000
## milk       0.0064 0.2635     1.0000 1.0000 1.0000         1.0000
## wine       1.0000 1.0000     1.0000 1.0000 1.0000  1.0000</code></pre>
<p>KMO Test (Kaiser-Meyer-Olkin)</p>
<pre class="r"><code>library(psych)

KMO(food)</code></pre>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = food)
## Overall MSA =  0.46
## MSA for each item = 
##      bread vegetables     fruits       meat    poultry       milk       wine 
##       0.55       0.51       0.50       0.48       0.46       0.39       0.25</code></pre>
<ul>
<li>0.00 to 0.49 unacceptable</li>
<li>0.50 to 0.59 miserable</li>
</ul>
<p>The Kaiser–Meyer–Olkin (KMO) test is a statistical measure to determine how suited data is for factor analysis.</p>
<p>Factor analysis does not seem to be very suitable for our data.</p>
<pre class="r"><code>scree(food, pc=FALSE)  # Use pc=FALSE for factor analysis</code></pre>
<pre><code>## Warning in fa.stats(r = r, f = f, phi = phi, n.obs = n.obs, np.obs = np.obs, :
## The estimated weights for the factor scores are probably incorrect. Try a
## different factor score estimation method.</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-4-1.png" width="672" /> Two axes will be chosen to explain FA.</p>
<p>Realisation FA</p>
<pre class="r"><code>fa.food &lt;- factanal(food, factors = 2, rotation=&quot;varimax&quot;) #factor = 2 : number axis.
print(fa.food, digits=2, cutoff=.6, sort=TRUE)</code></pre>
<pre><code>## 
## Call:
## factanal(x = food, factors = 2, rotation = &quot;varimax&quot;)
## 
## Uniquenesses:
##      bread vegetables     fruits       meat    poultry       milk       wine 
##       0.27       0.09       0.09       0.00       0.01       0.00       0.79 
## 
## Loadings:
##            Factor1 Factor2
## vegetables  0.75          
## fruits      0.93          
## meat        0.96          
## poultry     0.99          
## bread               0.85  
## milk                0.99  
## wine                      
## 
##                Factor1 Factor2
## SS loadings       3.55    2.20
## Proportion Var    0.51    0.31
## Cumulative Var    0.51    0.82
## 
## Test of the hypothesis that 2 factors are sufficient.
## The chi square statistic is 23.27 on 8 degrees of freedom.
## The p-value is 0.00303</code></pre>
<pre class="r"><code>library(psych)

loads &lt;- fa.food$loadings

fa.diagram(loads)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-6-1.png" width="672" /> axis 1 : poultry / meat / fruits / vegetables / (wine..)</p>
<p>axis 2 : Milk / bread</p>
<pre class="r"><code>load &lt;- fa.food$loadings[,1:2] 
plot(load,type=&quot;n&quot;) 
text(load,labels=names(food),cex=.7)

lines(c(-1,1),c(0,0), lty = 3)
lines(c(0,0),c(-1,1), lty = 3)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>rbPal &lt;- colorRampPalette(c(&#39;red&#39;,&#39;blue&#39;))

loadings &lt;- data.frame(fa.food$loadings[,1:2])

loadings$colF1 &lt;- rbPal(20)[as.numeric(cut(loadings[,1],breaks = seq(-1,1,length = 20)))]
loadings$nam1 &lt;- paste(row.names(loadings), round(loadings[,1], digits = 3), sep = &quot;\n&quot;)
loadings$colF2 &lt;- rbPal(20)[as.numeric(cut(loadings[,2],breaks = seq(-1,1,length = 20)))]
loadings$nam2 &lt;- paste(row.names(loadings), round(loadings[,2], digits = 3), sep = &quot;\n&quot;)


par(mfrow = c(2,1))
barplot(abs(loadings[,1]), col = loadings$colF1, ylim = c(0,1), ylab = &quot;Factor 1&quot;, names.arg = loadings$nam1, cex.names = 0.8)
barplot(abs(loadings[,2]), col = loadings$colF2, ylim = c(0,1), ylab = &quot;Factor 2&quot;, names.arg = loadings$nam2, cex.names = 0.8)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-8-1.png" width="672" /> representation of each variable on each axis</p>
<pre class="r"><code>round(fa.food$loadings, 3)</code></pre>
<pre><code>## 
## Loadings:
##            Factor1 Factor2
## bread       0.101   0.850 
## vegetables  0.754   0.588 
## fruits      0.926   0.236 
## meat        0.959   0.275 
## poultry     0.985   0.131 
## milk        0.105   0.992 
## wine       -0.459         
## 
##                Factor1 Factor2
## SS loadings      3.548   2.204
## Proportion Var   0.507   0.315
## Cumulative Var   0.507   0.822</code></pre>
<p>Comparaison with PCA :</p>
<p>During the PCA we also noticed that it was necessary to keep just 2 axes.</p>
<p>Resultat :</p>
<pre class="r"><code>res&lt;-PCA(food, scale.unit = TRUE, ncp = 5, graph = F)
var &lt;- get_pca_var(res)
corrplot(var$contrib, is.corr=FALSE)</code></pre>
<p><img src="practical7_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>This graph shows that the important variables for each axis are the same for PCA and FA.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>